# 综合功能演示 (Comprehensive Features Demo)

## 概述

这是一个全面展示Go表达式引擎功能的演示程序，从简单的基础表达式到复杂的管道占位符语法，涵盖了引擎的所有核心特性。

## 🚀 运行演示

```bash
cd example/comprehensive_features_demo
go run main.go
```

## 📋 演示内容

### 1. 基础表达式演示
- 算术运算：`2 + 3 * 4`
- 字符串连接：`'Hello' + ' ' + 'World'`
- 布尔逻辑：`true && (false || true)`
- 三元条件：`42 > 30 ? 'large' : 'small'`
- 内置函数：`abs(-42)`, `max(1, 5, 3, 9, 2)`

### 2. 变量和环境演示
- 对象属性访问：`user.Name`, `user.Age >= 25`
- 环境变量使用：`user.Balance > threshold`
- 字符串操作：`prefix + user.Name`
- 复合条件：`user.Active && user.Balance > threshold`
- 数组长度：`len(user.Tags)`
- 字符串函数：`contains(user.Email, '@')`
- 映射访问：`user.Metadata['level']`

### 3. 数组和集合操作演示
- 基础函数：`len()`, `sum()`, `avg()`, `max()`, `min()`
- 数组索引：`numbers[0]`, `numbers[len(numbers)-1]`

### 4. 🔥 管道占位符语法演示 (核心功能)
- **基础过滤**：`numbers | filter(# > 5)`
- **条件过滤**：`numbers | filter(# % 2 == 0)` (偶数)
- **数据映射**：`numbers | map(# * 2)`
- **链式操作**：`numbers | filter(# > 3) | map(# * 2)`
- **复杂表达式**：`numbers | filter(# % 2 == 1) | map(# * #)` (奇数的平方)
- **动态阈值**：`numbers | filter(# > threshold / 10)`

### 5. 复杂表达式演示
- **多级管道**：`numbers | filter(# > 3) | map(# * 2 + 1) | filter(# % 3 == 0)`
- **条件映射**：`numbers | filter(# % 2 == 0 && # > 4) | map(# * # - 1)`
- **三元表达式**：`numbers | map(# > 5 ? # * 10 : # * 2)`

### 6. 字符串处理演示
- 大小写转换：`upper()`, `lower()`
- 字符串分割：`split(csv, ',')`
- 数组连接：`join(words, '-')`
- 字符串检查：`contains()`, `startsWith()`, `endsWith()`

### 7. 类型转换和验证演示
- 类型检查：`type(42)`, `type('hello')`
- 类型转换：`string(123)`, `int('42')`, `float('3.14')`, `bool('true')`

### 8. 性能演示
- 编译一次，多次执行的性能测试
- 不同类型表达式的执行速度对比
- 管道操作的性能表现

### 9. 错误处理演示
- 未定义变量错误
- 类型不匹配错误
- 函数参数错误
- 运行时错误捕获

### 10. 🚀 高级管道占位符演示
- **复合条件过滤**：`numbers | filter(# > 2 && # < 8) | map(# * 3 - 1)`
- **条件映射**：`numbers | map(# % 3 == 0 ? 'fizz' : string(#))`
- **三级管道**：`numbers | filter(# % 2 == 0) | map(# + 10) | filter(# > 15)`
- **数学表达式**：`numbers | map((# + 1) * (# - 1))`
- **聚合终结**：`numbers | filter(# >= 3 && # <= 7) | map(# * 2) | sum`

## 🎯 核心亮点

### 管道占位符语法 (`#`)
这是表达式引擎的**核心创新功能**，提供了比传统Lambda语法更简洁的写法：

```go
// 传统写法 (如果支持)
numbers | filter(x => x > 5) | map(x => x * 2)

// 占位符语法 (我们的创新)
numbers | filter(# > 5) | map(# * 2)
```

**优势：**
- 代码量减少约50%
- 清晰的数据流向
- 支持任意复杂的嵌套表达式
- 完整的类型安全检查

### 支持的复杂表达式
- 算术运算：`+`, `-`, `*`, `/`, `%`
- 比较运算：`>`, `<`, `>=`, `<=`, `==`, `!=`
- 逻辑运算：`&&`, `||`
- 条件表达式：`condition ? true_value : false_value`
- 嵌套表达式：`(# + 1) * (# - 1)`
- 复合条件：`# > 2 && # < 8`

## 📊 预期输出示例

```
🚀 Go Expression Engine - 综合功能演示
============================================================

📝 1. 基础表达式演示
------------------------------
✅ 2 + 3 * 4                    → 14
✅ 'Hello' + ' ' + 'World'       → Hello World
✅ true && (false || true)       → true
✅ 42 > 30 ? 'large' : 'small'   → large
✅ abs(-42)                      → 42
✅ max(1, 5, 3, 9, 2)           → 9

🔥 4. 管道占位符语法演示 (核心功能)
---------------------------------------------
✅ numbers | filter(# > 5)                → [6 7 8 9 10]
   💡 过滤大于5的数字

✅ numbers | filter(# % 2 == 0)           → [2 4 6 8 10]
   💡 过滤偶数

✅ numbers | map(# * 2)                   → [2 4 6 8 10 12 14 16 18 20]
   💡 每个数字乘以2

✅ numbers | filter(# > 3) | map(# * 2)   → [8 10 12 14 16 18 20]
   💡 链式操作：过滤后映射
```

## 🛠️ 技术特性

- **零反射架构**：完全不使用Go反射，高性能执行
- **类型安全**：编译时类型检查，运行时类型转换
- **错误处理**：完善的错误捕获和报告机制
- **高性能**：编译一次，多次执行的优化模式
- **兼容性**：与主流表达式引擎API兼容

## 📈 性能特点

- **编译速度**：微秒级编译时间
- **执行速度**：支持高频率表达式求值
- **内存效率**：最小化内存分配和垃圾回收
- **缓存优化**：编译结果可重复使用

这个演示程序展示了表达式引擎从基础功能到高级特性的完整能力，特别突出了管道占位符语法这一核心创新功能。 